library(dplyr)
library(dplyr)
library(dplyr)
install.packages("dplyr")
library(dplyr)
# Import the relevant libraries
suppressWarnings(library(plyr))
suppressWarnings(library(tseries))
suppressWarnings(library(forecast))
suppressWarnings(library(lmtest))
suppressWarnings(library(car))
library(dplyr)
# Import the relevant libraries
suppressWarnings(library(plyr))
suppressWarnings(library(tseries))
suppressWarnings(library(forecast))
suppressWarnings(library(lmtest))
#suppressWarnings(library(car))
suppressWarnings(library(arfima))
library(dplyr)
# Import the relevant libraries
#suppressWarnings(library(plyr))
suppressWarnings(library(tseries))
suppressWarnings(library(forecast))
suppressWarnings(library(lmtest))
#suppressWarnings(library(car))
#suppressWarnings(library(arfima))
#suppressWarnings(library(tsibble))
suppressWarnings(library(ggplot2))
suppressWarnings(library(gridExtra))
#suppressWarnings(library(zoo))
nyctaxi.data <- read.csv("./nyc_taxi.csv")
head(nyctaxi.data)
tail(nyctaxi.data)
dim(nyctaxi.data)
nyctaxi.data$timestamp_dt <- as.POSIXct(nyctaxi.data$timestamp)
#nyctaxi.data$value_boxcox <- BoxCox(nyctaxi.data$value, lambda = 3.5)
#head(nyctaxi.data)
plot1 <- ggplot(nyctaxi.data, aes(x = value)) + geom_histogram() + theme_light()
plot2 <- ggplot(nyctaxi.data, aes(sample = value)) +  geom_line(mapping=aes(x=timestamp_dt, y=value)) + theme_light()
grid.arrange(plot1, plot2, nrow=3)
acf(nyctaxi.data$value)
subsamp <- nyctaxi.data[nyctaxi.data$timestamp_dt < as.POSIXct("2014-07-08 00:00:00"),]
plot1 <- ggplot(subsamp, aes(x = value)) + geom_histogram() + theme_light()
plot2 <- ggplot(subsamp, aes(sample = value)) +  geom_line(mapping=aes(x=timestamp_dt, y=value)) + theme_light()
grid.arrange(plot1, plot2, nrow=2)
anomaly_points <- as.POSIXct(c(
"2014-11-01 19:00:00",
"2014-11-27 15:30:00",
"2014-12-25 15:00:00",
"2015-01-01 01:00:00",
"2015-01-27 00:00:00"
))
nyctaxi.data$flag_anomaly <- ifelse(nyctaxi.data$timestamp_dt %in% anomaly_points, TRUE, FALSE)
nyctaxi.data %>% filter(timestamp_dt %in% anomaly_points)
#ggsave(filename="taxi_anomalies.pdf", w=20, h=5, dpi=500)
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value), data=nyctaxi.data) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
# Recheck for stationarity
kpss.test(nyctaxi.data$value)
adf.test(nyctaxi.data$value, alternative="stationary", k=10)
pp.test(nyctaxi.data$value)
ma.order <- 24*2*7
trend_nyc = ma(nyctaxi.data$value, order = ma.order, centre = T)
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value), color="black", data=nyctaxi.data) +
geom_line(mapping=aes(x=nyctaxi.data$timestamp_dt, y=trend_nyc), color="red")
nyc_ma = ts(na.omit(nyctaxi.data$value),
frequency=ma.order)
decomp = stl(nyc_ma, s.window="periodic")
nyctaxi.data$value_deseas <- seasadj(decomp)
plot(decomp)
acf(nyctaxi.data$value_deseas)
ggsave(filename="taxi_anomalies_2.pdf", w=20, h=5, dpi=500)
ggplot() +
#geom_line(mapping=aes(x=timestamp_dt, y=value_deseas), color="black", data=nyctaxi.data) +
geom_line(mapping=aes(x=timestamp_dt, y=value), color="black", alpha=1, data=nyctaxi.data) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
kpss.test(nyctaxi.data$value_deseas)
adf.test(nyctaxi.data$value_deseas, alternative="stationary", k=10)
pp.test(nyctaxi.data$value)
library(dplyr)
# Import the relevant libraries
#suppressWarnings(library(plyr))
suppressWarnings(library(tseries))
suppressWarnings(library(forecast))
suppressWarnings(library(lmtest))
#suppressWarnings(library(car))
#suppressWarnings(library(arfima))
#suppressWarnings(library(tsibble))
suppressWarnings(library(ggplot2))
suppressWarnings(library(gridExtra))
#suppressWarnings(library(zoo))
nyctaxi.data <- read.csv("./nyc_taxi.csv")
head(nyctaxi.data)
tail(nyctaxi.data)
dim(nyctaxi.data)
nyctaxi.data$timestamp_dt <- as.POSIXct(nyctaxi.data$timestamp)
#nyctaxi.data$value_boxcox <- BoxCox(nyctaxi.data$value, lambda = 3.5)
#head(nyctaxi.data)
plot1 <- ggplot(nyctaxi.data, aes(x = value)) + geom_histogram() + theme_light()
plot2 <- ggplot(nyctaxi.data, aes(sample = value)) +  geom_line(mapping=aes(x=timestamp_dt, y=value)) + theme_light()
grid.arrange(plot1, plot2, nrow=3)
acf(nyctaxi.data$value)
subsamp <- nyctaxi.data[nyctaxi.data$timestamp_dt < as.POSIXct("2014-07-08 00:00:00"),]
plot1 <- ggplot(subsamp, aes(x = value)) + geom_histogram() + theme_light()
plot2 <- ggplot(subsamp, aes(sample = value)) +  geom_line(mapping=aes(x=timestamp_dt, y=value)) + theme_light()
grid.arrange(plot1, plot2, nrow=2)
anomaly_points <- as.POSIXct(c(
"2014-11-01 19:00:00",
"2014-11-27 15:30:00",
"2014-12-25 15:00:00",
"2015-01-01 01:00:00",
"2015-01-27 00:00:00"
))
nyctaxi.data$flag_anomaly <- ifelse(nyctaxi.data$timestamp_dt %in% anomaly_points, TRUE, FALSE)
nyctaxi.data %>% filter(timestamp_dt %in% anomaly_points)
#ggsave(filename="taxi_anomalies.pdf", w=20, h=5, dpi=500)
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value), data=nyctaxi.data) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
# Recheck for stationarity
kpss.test(nyctaxi.data$value)
adf.test(nyctaxi.data$value, alternative="stationary", k=10)
pp.test(nyctaxi.data$value)
ma.order <- 24*2*7
trend_nyc = ma(nyctaxi.data$value, order = ma.order, centre = T)
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value), color="black", data=nyctaxi.data) +
geom_line(mapping=aes(x=nyctaxi.data$timestamp_dt, y=trend_nyc), color="red")
nyc_ma = ts(na.omit(nyctaxi.data$value),
frequency=ma.order)
decomp = stl(nyc_ma, s.window="periodic")
nyctaxi.data$value_deseas <- seasadj(decomp)
plot(decomp)
acf(nyctaxi.data$value_deseas)
ggsave(filename="taxi_anomalies_2.pdf", w=20, h=5, dpi=500)
ggplot() +
#geom_line(mapping=aes(x=timestamp_dt, y=value_deseas), color="black", data=nyctaxi.data) +
geom_line(mapping=aes(x=timestamp_dt, y=value), color="black", alpha=1, data=nyctaxi.data) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
kpss.test(nyctaxi.data$value_deseas)
adf.test(nyctaxi.data$value_deseas, alternative="stationary", k=10)
pp.test(nyctaxi.data$value)
ggsave(filename="taxi_anomalies_2.pdf", w=20, h=5, dpi=500)
ggplot() +
#geom_line(mapping=aes(x=timestamp_dt, y=value_deseas), color="black", data=nyctaxi.data) +
geom_line(mapping=aes(x=timestamp_dt, y=value), color="black", alpha=1, data=nyctaxi.data) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
library(dplyr)
# Import the relevant libraries
suppressWarnings(library(plyr))
suppressWarnings(library(tseries))
suppressWarnings(library(forecast))
suppressWarnings(library(lmtest))
#suppressWarnings(library(car))
#suppressWarnings(library(arfima))
#suppressWarnings(library(tsibble))
suppressWarnings(library(ggplot2))
suppressWarnings(library(zoo))
mf.tsdata <- read.csv("./machine_temperature_system_failure.csv")
head(mf.tsdata)
plot.ts(mf.tsdata$value)
acf(mf.tsdata$value, main="ACF plot")
kpss.test(mf.tsdata$value)
adf.test(mf.tsdata$value, alternative="stationary", k=10)
mf_ma = ts(na.omit(mf.tsdata$value),
frequency=300)
decomp = stl(mf_ma, s.window="periodic")
mf.tsdata$value_deseas <- seasadj(decomp)
plot(decomp)
# Recheck for stationarity
kpss.test(mf.tsdata$value_deseas)
adf.test(mf.tsdata$value_deseas, alternative="stationary", k=10)
pp.test(mf.tsdata$value)
library(dplyr)
# Import the relevant libraries
#suppressWarnings(library(plyr))
suppressWarnings(library(tseries))
suppressWarnings(library(forecast))
suppressWarnings(library(lmtest))
#suppressWarnings(library(car))
#suppressWarnings(library(arfima))
#suppressWarnings(library(tsibble))
suppressWarnings(library(ggplot2))
suppressWarnings(library(gridExtra))
#suppressWarnings(library(zoo))
nyctaxi.data <- read.csv("./nyc_taxi.csv")
head(nyctaxi.data)
tail(nyctaxi.data)
dim(nyctaxi.data)
nyctaxi.data$timestamp_dt <- as.POSIXct(nyctaxi.data$timestamp)
#nyctaxi.data$value_boxcox <- BoxCox(nyctaxi.data$value, lambda = 3.5)
#head(nyctaxi.data)
plot1 <- ggplot(nyctaxi.data, aes(x = value)) + geom_histogram() + theme_light()
plot2 <- ggplot(nyctaxi.data, aes(sample = value)) +  geom_line(mapping=aes(x=timestamp_dt, y=value)) + theme_light()
grid.arrange(plot1, plot2, nrow=3)
acf(nyctaxi.data$value)
subsamp <- nyctaxi.data[nyctaxi.data$timestamp_dt < as.POSIXct("2014-07-08 00:00:00"),]
plot1 <- ggplot(subsamp, aes(x = value)) + geom_histogram() + theme_light()
plot2 <- ggplot(subsamp, aes(sample = value)) +  geom_line(mapping=aes(x=timestamp_dt, y=value)) + theme_light()
grid.arrange(plot1, plot2, nrow=2)
anomaly_points <- as.POSIXct(c(
"2014-11-01 19:00:00",
"2014-11-27 15:30:00",
"2014-12-25 15:00:00",
"2015-01-01 01:00:00",
"2015-01-27 00:00:00"
))
nyctaxi.data$flag_anomaly <- ifelse(nyctaxi.data$timestamp_dt %in% anomaly_points, TRUE, FALSE)
nyctaxi.data %>% filter(timestamp_dt %in% anomaly_points)
nyc.anomaly.1 <- nyctaxi.data[(nyctaxi.data$timestamp_dt > as.POSIXct("2014-10-28 00:00:00"))&
(nyctaxi.data$timestamp_dt <= as.POSIXct("2014-11-05 00:00:00")),]
nyc.anomaly.2 <- nyctaxi.data[(nyctaxi.data$timestamp_dt > as.POSIXct("2014-11-23 00:00:00"))&
(nyctaxi.data$timestamp_dt <= as.POSIXct("2014-11-30 00:00:00")),]
nyc.anomaly.3 <- nyctaxi.data[(nyctaxi.data$timestamp_dt > as.POSIXct("2014-12-22 00:00:00"))&
(nyctaxi.data$timestamp_dt <= as.POSIXct("2014-12-28 00:00:00")),]
nyc.anomaly.4 <- nyctaxi.data[(nyctaxi.data$timestamp_dt > as.POSIXct("2014-12-28 00:00:00"))&
(nyctaxi.data$timestamp_dt <= as.POSIXct("2015-01-03 00:00:00")),]
nyc.anomaly.5 <- nyctaxi.data[(nyctaxi.data$timestamp_dt > as.POSIXct("2015-01-24 00:00:00"))&
(nyctaxi.data$timestamp_dt <= as.POSIXct("2015-01-31 00:00:00")),]
#ggsave(filename="taxi_anomalies.pdf", w=20, h=5, dpi=500)
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value), data=nyctaxi.data) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value), data=nyc.anomaly.1) +
geom_vline(xintercept=as.numeric(anomaly_points[1]), linetype="dotted", color="red", size=1) +
theme_light()
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value), data=nyc.anomaly.2) +
geom_vline(xintercept=as.numeric(anomaly_points[2]), linetype="dotted", color="red", size=1) +
theme_light()
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value), data=nyc.anomaly.3) +
geom_vline(xintercept=as.numeric(anomaly_points[3]), linetype="dotted", color="red", size=1) +
theme_light()
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value), data=nyc.anomaly.4) +
geom_vline(xintercept=as.numeric(anomaly_points[4]), linetype="dotted", color="red", size=1) +
theme_light()
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value), data=nyc.anomaly.5) +
geom_vline(xintercept=as.numeric(anomaly_points[5]), linetype="dotted", color="red", size=1) +
theme_light()
# Recheck for stationarity
kpss.test(nyctaxi.data$value)
adf.test(nyctaxi.data$value, alternative="stationary", k=10)
pp.test(nyctaxi.data$value)
ma.order <- 24*2*7
trend_nyc = ma(nyctaxi.data$value, order = ma.order, centre = T)
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value), color="black", data=nyctaxi.data) +
geom_line(mapping=aes(x=nyctaxi.data$timestamp_dt, y=trend_nyc), color="red")
nyc_ma = ts(na.omit(nyctaxi.data$value),
frequency=ma.order)
decomp = stl(nyc_ma, s.window="periodic")
nyctaxi.data$value_deseas <- seasadj(decomp)
plot(decomp)
acf(nyctaxi.data$value_deseas)
ggsave(filename="taxi_anomalies_2.pdf", w=20, h=5, dpi=500)
ggplot() +
#geom_line(mapping=aes(x=timestamp_dt, y=value_deseas), color="black", data=nyctaxi.data) +
geom_line(mapping=aes(x=timestamp_dt, y=value), color="black", alpha=1, data=nyctaxi.data) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
kpss.test(nyctaxi.data$value_deseas)
adf.test(nyctaxi.data$value_deseas, alternative="stationary", k=10)
pp.test(nyctaxi.data$value)
nyc.subsamp <- nyctaxi.data[(nyctaxi.data$timestamp_dt > as.POSIXct("2014-09-01 00:00:00"))&
(nyctaxi.data$timestamp_dt <= as.POSIXct("2014-11-05 00:00:00")),]
train.data <- nyc.subsamp[nyc.subsamp$timestamp_dt < as.POSIXct("2014-10-28 00:00:00"),]
test.data <- nyc.subsamp[(nyc.subsamp$timestamp_dt >= as.POSIXct("2014-10-28 00:00:00"))&
(nyc.subsamp$timestamp_dt <= as.POSIXct("2014-11-15 00:00:00")),]
nyc.subsamp.ts = ts(as.numeric(nyc.subsamp$value),
start=c(1,1),
frequency = 24*2*7)
autoplot(nyc.subsamp.ts)
train.data.daily.ts = ts(as.numeric(train.data$value),
start=c(1,1),
frequency = 24*2*7)
autoplot(train.data.daily.ts)
arima.model.auto <- auto.arima(train.data.daily.ts, seasonal = TRUE)
summary(arima.model.auto)
arima.model.auto.fcast <- forecast(arima.model.auto, h=nrow(test.data))
plot(arima.model.auto.fcast)
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value, color="ori"), data=test.data) +
geom_line(mapping=aes(x=test.data$timestamp_dt, y=arima.model.auto.fcast$mean, color="pred")) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
ggsave(filename="anomaly_1_pred.pdf", w=20, h=5, dpi=500)
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value, color="ori"), data=test.data) +
geom_line(mapping=aes(x=test.data$timestamp_dt, y=arima.model.auto.fcast$mean, color="pred")) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
ggsave(filename="anomaly_1_pred.pdf", w=20, h=5, dpi=500)
hist(train.data$value)
nyc.subsamp.ts = ts(as.numeric(nyc.subsamp$value_deseas),
start=c(1,1),
frequency = 24*2*7)
autoplot(nyc.subsamp.ts)
hist(nyc.subsamp.ts)
train.data.daily.ts = ts(as.numeric(train.data$value_deseas),
start=c(1,1),
frequency = 24*2*7)
autoplot(train.data.daily.ts)
#nyc.subsamp <- nyctaxi.data[(nyctaxi.data$timestamp_dt > as.POSIXct("2014-09-01 00:00:00"))&
#                              (nyctaxi.data$timestamp_dt <= as.POSIXct("2014-11-05 00:00:00")),]
nyc.subsamp <- nyctaxi.data[(nyctaxi.data$timestamp_dt <= as.POSIXct("2014-11-05 00:00:00")),]
train.data <- nyc.subsamp[nyc.subsamp$timestamp_dt < as.POSIXct("2014-10-28 00:00:00"),]
test.data <- nyc.subsamp[(nyc.subsamp$timestamp_dt >= as.POSIXct("2014-10-28 00:00:00"))&
(nyc.subsamp$timestamp_dt <= as.POSIXct("2014-11-15 00:00:00")),]
nyc.subsamp.ts = ts(as.numeric(nyc.subsamp$value_deseas),
start=c(1,1),
frequency = 24*2*7)
autoplot(nyc.subsamp.ts)
hist(nyc.subsamp.ts)
train.data.daily.ts = ts(as.numeric(train.data$value_deseas),
start=c(1,1),
frequency = 24*2*7)
autoplot(train.data.daily.ts)
arima.model.auto <- auto.arima(train.data.daily.ts, seasonal = TRUE)
summary(arima.model.auto)
arima.model.auto.fcast <- forecast(arima.model.auto, h=nrow(test.data))
plot(arima.model.auto.fcast)
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value, color="ori"), data=test.data) +
geom_line(mapping=aes(x=test.data$timestamp_dt, y=arima.model.auto.fcast$mean, color="pred")) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
ggsave(filename="anomaly_1_pred.pdf", w=20, h=5, dpi=500)
arima.model.auto <- auto.arima(train.data.daily.ts, seasonal = FALSE)
summary(arima.model.auto)
arima.model.auto.fcast <- forecast(arima.model.auto, h=nrow(test.data))
plot(arima.model.auto.fcast)
nyc.subsamp <- nyctaxi.data[(nyctaxi.data$timestamp_dt > as.POSIXct("2014-09-01 00:00:00"))&
(nyctaxi.data$timestamp_dt <= as.POSIXct("2014-11-05 00:00:00")),]
train.data <- nyc.subsamp[nyc.subsamp$timestamp_dt < as.POSIXct("2014-10-28 00:00:00"),]
test.data <- nyc.subsamp[(nyc.subsamp$timestamp_dt >= as.POSIXct("2014-10-28 00:00:00"))&
(nyc.subsamp$timestamp_dt <= as.POSIXct("2014-11-15 00:00:00")),]
nyc.subsamp.ts = ts(as.numeric(nyc.subsamp$value_deseas),
start=c(1,1),
frequency = 24*2*7)
autoplot(nyc.subsamp.ts)
hist(nyc.subsamp.ts)
nyc.subsamp.ts = ts(as.numeric(nyc.subsamp$value),
start=c(1,1),
frequency = 24*2*7)
autoplot(nyc.subsamp.ts)
hist(nyc.subsamp.ts)
train.data.daily.ts = ts(as.numeric(train.data$value_deseas),
start=c(1,1),
frequency = 24*2*7)
autoplot(train.data.daily.ts)
train.data.daily.ts = ts(as.numeric(train.data$value),
start=c(1,1),
frequency = 24*2*7)
autoplot(train.data.daily.ts)
nyc.subsamp2 <- nyctaxi.data[(nyctaxi.data$timestamp_dt > as.POSIXct("2014-07-01 00:00:00"))&
(nyctaxi.data$timestamp_dt <= as.POSIXct("2014-11-05 00:00:00")),]
ggplot() +
geom_line(mapping=aes(x=value, y=timestamp_dt), data=nyc.subsamp)
ggplot() +
geom_line(mapping=aes(y=value, x=timestamp_dt), data=nyc.subsamp)
ggplot() +
geom_line(mapping=aes(y=value, x=timestamp_dt), data=nyc.subsamp2)
nyc.subsamp2 <- nyctaxi.data[(nyctaxi.data$timestamp_dt > as.POSIXct("2014-09-28 00:00:00"))&
(nyctaxi.data$timestamp_dt <= as.POSIXct("2014-10-04 00:00:00")),]
ggplot() +
geom_line(mapping=aes(y=value, x=timestamp_dt), data=nyc.subsamp2)
nyc.subsamp2 <- nyctaxi.data[(nyctaxi.data$timestamp_dt > as.POSIXct("2014-09-28 00:00:00"))&
(nyctaxi.data$timestamp_dt <= as.POSIXct("2014-10-05 00:00:00")),]
ggplot() +
geom_line(mapping=aes(y=value, x=timestamp_dt), data=nyc.subsamp2)
nyc.subsamp2 <- nyctaxi.data[(nyctaxi.data$timestamp_dt > as.POSIXct("2014-08-28 00:00:00"))&
(nyctaxi.data$timestamp_dt <= as.POSIXct("2014-09-05 00:00:00")),]
nyc.subsamp2 <- nyctaxi.data[(nyctaxi.data$timestamp_dt > as.POSIXct("2014-08-28 00:00:00"))&
(nyctaxi.data$timestamp_dt <= as.POSIXct("2014-09-05 00:00:00")),]
ggplot() +
geom_line(mapping=aes(y=value, x=timestamp_dt), data=nyc.subsamp2)
train.data.daily.ts = ts(as.numeric(train.data$value),
start=c(1,1),
frequency = 24*2*7)
autoplot(train.data.daily.ts)
arima.model.auto <- auto.arima(train.data.daily.ts, seasonal = TRUE)
summary(arima.model.auto)
arima.model.auto.fcast <- forecast(arima.model.auto, h=nrow(test.data))
plot(arima.model.auto.fcast)
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value, color="ori"), data=test.data) +
geom_line(mapping=aes(x=test.data$timestamp_dt, y=arima.model.auto.fcast$mean, color="pred")) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
ggsave(filename="anomaly_1_pred.pdf", w=20, h=5, dpi=500)
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value, color="ori"), data=test.data) +
geom_line(mapping=aes(x=test.data$timestamp_dt, y=arima.model.auto.fcast$mean, color="pred")) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
test.data <- nyc.subsamp[(nyc.subsamp$timestamp_dt >= as.POSIXct("2014-10-28 00:00:00"))&
(nyc.subsamp$timestamp_dt <= as.POSIXct("2014-12-01 00:00:00")),]
test.data <- nyc.subsamp[(nyc.subsamp$timestamp_dt >= as.POSIXct("2014-10-28 00:00:00"))&
(nyc.subsamp$timestamp_dt <= as.POSIXct("2014-12-01 00:00:00")),]
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value, color="ori"), data=test.data) +
geom_line(mapping=aes(x=test.data$timestamp_dt, y=arima.model.auto.fcast$mean, color="pred")) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
test.data <- nyc.subsamp[(nyc.subsamp$timestamp_dt >= as.POSIXct("2014-10-28 00:00:00"))&
(nyc.subsamp$timestamp_dt <= as.POSIXct("2014-12-01 00:00:00")),]
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value, color="ori"), data=test.data) +
geom_line(mapping=aes(x=test.data$timestamp_dt, y=arima.model.auto.fcast$mean, color="pred")) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
arima.model.auto.fcast <- forecast(arima.model.auto, h=nrow(test.data))
plot(arima.model.auto.fcast)
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value, color="ori"), data=test.data) +
geom_line(mapping=aes(x=test.data$timestamp_dt, y=arima.model.auto.fcast$mean, color="pred")) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value, color="ori"), data=test.data) +
#geom_line(mapping=aes(x=test.data$timestamp_dt, y=arima.model.auto.fcast$mean, color="pred")) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
nyc.subsamp <- nyctaxi.data[(nyctaxi.data$timestamp_dt > as.POSIXct("2014-09-01 00:00:00"))&
(nyctaxi.data$timestamp_dt <= as.POSIXct("2014-12-01 00:00:00")),]
test.data <- nyc.subsamp[(nyc.subsamp$timestamp_dt >= as.POSIXct("2014-10-28 00:00:00"))&
(nyc.subsamp$timestamp_dt <= as.POSIXct("2014-12-01 00:00:00")),]
arima.model.auto.fcast <- forecast(arima.model.auto, h=nrow(test.data))
arima.model.auto.fcast <- forecast(arima.model.auto, h=nrow(test.data))
plot(arima.model.auto.fcast)
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value, color="ori"), data=test.data) +
geom_line(mapping=aes(x=test.data$timestamp_dt, y=arima.model.auto.fcast$mean, color="pred")) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
ggsave(filename="anomaly_1_pred.pdf", w=20, h=5, dpi=500)
ggsave(filename="anomaly_1_pred.pdf", w=20, h=5, dpi=500)
ggplot() +
geom_line(mapping=aes(x=timestamp_dt, y=value, color="ori"), data=test.data) +
geom_line(mapping=aes(x=test.data$timestamp_dt, y=arima.model.auto.fcast$mean, color="pred")) +
geom_vline(xintercept=as.numeric(anomaly_points), linetype="dotted", color="red", size=1) +
theme_light()
ggsave(filename="anomaly_1_pred.pdf", w=20, h=5, dpi=500)
arima.model.auto.fcast$residuals
hist(arima.model.auto.fcast$residuals)
hist(arima.model.auto.fcast$residuals)
qqnorm(arima.model.auto.fcast$residuals)
qqline()
hist(arima.model.auto.fcast$residuals)
qqnorm(arima.model.auto.fcast$residuals)
qqline()
hist(arima.model.auto.fcast$residuals)
qqnorm(arima.model.auto.fcast$residuals)
qqline(arima.model.auto.fcast$residuals)
#ggplot(mf.tsdata, aes(sample = value_boxcox)) + stat_qq() + stat_qq_line()
plot(arima.model.auto.fcast$residuals)
hist(arima.model.auto.fcast$residuals)
qqnorm(arima.model.auto.fcast$residuals)
qqline(arima.model.auto.fcast$residuals)
plot(arima.model.auto.fcast$residuals)
(recursive.mse <- mean((as.vector(test.data$value) - as.vector(arima.model.auto.fcast$mean))^2))
mse.vec <- (as.vector(test.data$value) - as.vector(arima.model.auto.fcast$mean))^2
plot(mse.vec)
(recursive.mse <- mean(mse.vec))
test.data <- nyc.subsamp[(nyc.subsamp$timestamp_dt >= as.POSIXct("2014-10-28 00:00:00"))&
(nyc.subsamp$timestamp_dt <= as.POSIXct("2014-11-05 00:00:00")),]
summary(arima.model.auto)
arima.model.auto.fcast <- forecast(arima.model.auto, h=nrow(test.data))
plot(arima.model.auto.fcast)
save.image("C:/Users/SSrih/Desktop/porn.RData")
